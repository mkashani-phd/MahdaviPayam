#  <img src="img/Mahdavi-payam.png" alt="Mahdavi Payam logo" width="60" style="vertical-align: middle;" /> Mahdavi Payam (Ù…Ù‡Ø¯ÙˆÛŒ Ù¾ÛŒØ§Ù…)


---

<div dir="rtl">

## Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ (Persian Guide)

**Ù…Ù‡Ø¯ÙˆÛŒ Ù¾ÛŒØ§Ù…** ÛŒÚ© Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ÛŒ Ø¨Ø§ Ø§Ù…Ù†ÛŒØª Ø¨Ø§Ù„Ø§ Ø§Ø³Øª Ú©Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÛŒØ¯ Ø§ØµØ§Ù„Øª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ù…Ø¶Ø§ Ø´Ø¯Ù‡ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ú©Ø¯Ù‡Ø§ÛŒ QR Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù‡Ø¯Ù Ø§ØµÙ„ÛŒ Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø§ÛŒÙ† Ø§Ø³Øª Ú©Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø±ÛŒØ§ÙØªÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙˆØ§Ù‚Ø¹ÛŒØŒ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ùˆ Ø§Ø² Ù…Ù†Ø¨Ø¹ÛŒ Ù…ÙˆØ±Ø¯ Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø§Ø³Øª.

> ğŸ’¡ **Powered by:** [freeiranprotests.com](https://freeiranprotests.com)

### ğŸ“± Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù„ÛŒ
Ø§ÛŒÙ† Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ© Ø§Ø³Ú©Ù†Ø± QR ØªØ®ØµØµÛŒ Ø¹Ù…Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø¨Ù‡ Ø¬Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† Ù…ØªÙ† Ø³Ø§Ø¯Ù‡ØŒ ÛŒÚ© Ø³Ø§Ø®ØªØ§Ø± JSON Ø§Ù…Ù† Ø´Ø§Ù…Ù„ Ù¾ÛŒØ§Ù… Ùˆ Ø§Ù…Ø¶Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ø±Ø§ ØªØ¬Ø²ÛŒÙ‡ Ùˆ ØªØ­Ù„ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

*   **âš¡ Ø§Ø³Ú©Ù† Ø®ÙˆØ¯Ú©Ø§Ø±**: ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ÙÙˆØ±ÛŒ Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ Ù¾Ø³ Ø§Ø² Ø§Ø¬Ø±Ø§.
*   **ğŸ–¼ï¸ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ú¯Ø§Ù„Ø±ÛŒ**: Ø§Ù…Ú©Ø§Ù† Ø§Ù†ØªØ®Ø§Ø¨ ØªØµØ§ÙˆÛŒØ± Ú©Ø¯ QR Ø§Ø² Ø­Ø§ÙØ¸Ù‡ Ú¯ÙˆØ´ÛŒ.
*   **ğŸ¨ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨ÙˆÙ…ÛŒ**: Ù…Ø­ÛŒØ· Ú©Ø§Ù…Ù„Ø§Ù‹ ÙØ§Ø±Ø³ÛŒ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ù¾Ø³Ù†Ø¯.
*   **ğŸ”” ØªØ§ÛŒÛŒØ¯ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ**: Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯ Ø¨ØµØ±ÛŒ ÙÙˆØ±ÛŒ (âœ… ØªØ§ÛŒÛŒØ¯ Ø´Ø¯ ÛŒØ§ âŒ Ø®Ø·Ø§) Ø§Ø² Ø·Ø±ÛŒÙ‚ Dialog.

### ğŸ”’ Ø¬Ø²Ø¦ÛŒØ§Øª Ø§Ù…Ù†ÛŒØªÛŒ
Ù…Ù‡Ø¯ÙˆÛŒ Ù¾ÛŒØ§Ù… Ø§Ø² ÛŒÚ© Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú†Ù†Ø¯Ù„Ø§ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§ÙØ¸Øª Ø§Ø² ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:

1.  **Ø­ÙØ§Ø¸Øª Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ (Anti-Tampering):**
    *   **Ú¯ÙˆØ§Ù‡ÛŒ Certificate Pinning**: Ù‡Ø´ SHA-256 Ú¯ÙˆØ§Ù‡ÛŒ Ø±Ø³Ù…ÛŒ Ø¯Ø± Ú©Ø¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Hard-code Ø´Ø¯Ù‡ Ø§Ø³Øª.
    *   **ØªØ§ÛŒÛŒØ¯ Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§**: Ø§Ú¯Ø± Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´ÙˆØ¯ØŒ Ø³ÛŒØ³ØªÙ… Ø¢Ù† Ø±Ø§ Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.
2.  **Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù…Ù† Ú©Ù„ÛŒØ¯Ù‡Ø§:**
    *   Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `EncryptedSharedPreferences` Ø¨Ø§ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ **AES256**.
    *   Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² **StrongBox** (Ù…Ø§Ú˜ÙˆÙ„ Ø§Ù…Ù†ÛŒØª Ø³Ø®Øªâ€ŒØ§ÙØ²Ø§Ø±ÛŒ) Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ú©Ù„ÛŒØ¯.
3.  **Ù…ÙˆØªÙˆØ± Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ:**
    *   Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ù…Ø¯Ø±Ù† **Ed25519** (Ø§Ø² Ø·Ø±ÛŒÙ‚ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Google Tink).


**Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªØ£ÛŒÛŒØ¯ QR Ú©Ø¯ Ú©Ù„ÛŒØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø§Ù…Ø¶Ø§Ø´Ø¯Ù‡**

Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø§ÛŒÙ† QR Ú©Ø¯ØŒ Ù„Ø·ÙØ§Ù‹ Ø§Ø² **Ù‡Ù…ÛŒÙ† Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†** Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.

1. Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯.
2. ÙˆØ§Ø±Ø¯ Ø¨Ø®Ø´ **Scan** ÛŒØ§ **Verify** Ø´ÙˆÛŒØ¯.
3. Ù‡Ù…ÛŒÙ† QR Ú©Ø¯ Ø±Ø§ Ø§Ø³Ú©Ù† Ú©Ù†ÛŒØ¯.
4. Ù†ØªÛŒØ¬Ù‡ Ø¨Ø§ÛŒØ¯ ÙˆØ¶Ø¹ÛŒØª **Verified / Valid Signature** Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡Ø¯.

<p align="center">
  <img src="img/signed_public_key.png" alt="Signed public key QR code" width="200" />
</p>


---
</div>

## ğŸ‡¬ğŸ‡§ English Guide

**Mahdavi Payam** is a high-security Android application designed to verify the authenticity of signed messages delivered via QR codes. It ensures that information received is genuine, untampered, and originated from a trusted source.

> ğŸ’¡ **Powered by:** [freeiranprotests.com](https://freeiranprotests.com)

### ğŸ“± General Overview
The app functions as a specialized QR scanner that parses a secure JSON structure containing a message and its corresponding digital signature.

*   **âš¡ Automatic Scanning**: Launches the camera immediately upon startup.
*   **ğŸ–¼ï¸ Gallery Support**: Allows users to import and scan QR code images from the gallery.
*   **ğŸ”” Instant Verification**: Provides immediate feedback via a Farsi pop-up dialog.

### ğŸ”’ Security Implementation Details

#### 1. App Integrity Protection
*   **Certificate Pinning**: Stores a SHA-256 hash of the official signing certificate within the binary.
*   **Runtime Verification**: If the app is modified or resigned by an attacker, it automatically blocks usage to prevent phishing.

#### 2. Secure Key Management
*   **Hardware-Backed Storage**: Utilizes `EncryptedSharedPreferences`. On supported devices, it leverages **StrongBox Keymaster** to ensure keys never leave the hardware security module.

#### 3. Cryptographic Verification Engine
*   **Algorithm**: Employs **Ed25519** (via **Google Tink**), offering high performance and high security.
*   **Process**: Validates the digital signature against the pre-provisioned root public key.

### ğŸ“‘ Secure QR Data Format
The application expects a JSON structure with the following fields:

| Field | Purpose | Technical Detail |
| :--- | :--- | :--- |
| `k` | **Key Alias** | Identifies the signing key (e.g., "android") |
| `m` | **Message** | The actual content/text to be displayed |
| `s` | **Signature** | Ed25519 signature encoded in URL-safe Base64 |

---

### ğŸ›  Tech Stack
*   **Language**: Kotlin/Java (Android)
*   **Crypto Library**: Google Tink
*   **Scanning Engine**: ZXing / ML Kit
